

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>LDS package &mdash; Linear Dynamical Systems 1.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/asciiart.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="LDS.LDS package" href="LDS.LDS.html" />
    <link rel="prev" title="LDS" href="modules.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Linear Dynamical Systems
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">LDS</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">LDS package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.html">LDS.LDS package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-LDS.OnlineLDS_library">LDS.OnlineLDS_library module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lds-example-module">LDS.example module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-LDS.main">LDS.main module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-LDS">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Linear Dynamical Systems</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">LDS</a> &raquo;</li>
        
      <li>LDS package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/LDS.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="lds-package">
<h1>LDS package<a class="headerlink" href="#lds-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="LDS.LDS.html">LDS.LDS package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="LDS.LDS.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="LDS.LDS.ds.html">LDS.LDS.ds package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.ds.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.ds.html#module-LDS.LDS.ds.dynamical_system">LDS.LDS.ds.dynamical_system module</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.ds.html#module-LDS.LDS.ds">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="LDS.LDS.filters.html">LDS.LDS.filters package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.filters.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.filters.html#module-LDS.LDS.filters.filtering_abc_class">LDS.LDS.filters.filtering_abc_class module</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.filters.html#module-LDS.LDS.filters.filtering_siso">LDS.LDS.filters.filtering_siso module</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.filters.html#module-LDS.LDS.filters.kalman_em">LDS.LDS.filters.kalman_em module</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.filters.html#module-LDS.LDS.filters.kalman_filtering_siso">LDS.LDS.filters.kalman_filtering_siso module</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.filters.html#module-LDS.LDS.filters.wave_filtering_siso">LDS.LDS.filters.wave_filtering_siso module</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.filters.html#module-LDS.LDS.filters.wave_filtering_siso_abs">LDS.LDS.filters.wave_filtering_siso_abs module</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.filters.html#module-LDS.LDS.filters.wave_filtering_siso_ftl">LDS.LDS.filters.wave_filtering_siso_ftl module</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.filters.html#module-LDS.LDS.filters.wave_filtering_siso_ftl_persistent">LDS.LDS.filters.wave_filtering_siso_ftl_persistent module</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.filters.html#module-LDS.LDS.filters.wave_filtering_siso_persistent">LDS.LDS.filters.wave_filtering_siso_persistent module</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.filters.html#module-LDS.LDS.filters">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="LDS.LDS.h_m.html">LDS.LDS.h_m package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.h_m.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.h_m.html#module-LDS.LDS.h_m.hankel">LDS.LDS.h_m.hankel module</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.h_m.html#module-LDS.LDS.h_m">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="LDS.LDS.matlab_options.html">LDS.LDS.matlab_options package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.matlab_options.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.matlab_options.html#module-LDS.LDS.matlab_options.matlab_class_options">LDS.LDS.matlab_options.matlab_class_options module</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.matlab_options.html#module-LDS.LDS.matlab_options">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="LDS.LDS.online_lds.html">LDS.LDS.online_lds package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.online_lds.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.online_lds.html#module-LDS.LDS.online_lds.cost_ftl">LDS.LDS.online_lds.cost_ftl module</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.online_lds.html#module-LDS.LDS.online_lds.gradient_ftl">LDS.LDS.online_lds.gradient_ftl module</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.online_lds.html#module-LDS.LDS.online_lds.print_verbose">LDS.LDS.online_lds.print_verbose module</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.online_lds.html#module-LDS.LDS.online_lds">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="LDS.LDS.ts.html">LDS.LDS.ts package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.ts.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.ts.html#module-LDS.LDS.ts.time_series">LDS.LDS.ts.time_series module</a></li>
<li class="toctree-l4"><a class="reference internal" href="LDS.LDS.ts.html#module-LDS.LDS.ts">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="LDS.LDS.html#module-LDS.LDS">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-LDS.OnlineLDS_library">
<span id="lds-onlinelds-library-module"></span><h2>LDS.OnlineLDS_library module<a class="headerlink" href="#module-LDS.OnlineLDS_library" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="LDS.OnlineLDS_library.A_trans_calc">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">A_trans_calc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A_trans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.A_trans_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>MATLAB:
A_trans = A_trans - A_trans * grad’ * grad * A_trans/(1 + grad * A_trans * grad’);
we have to convert data[] from 1D vector to a numpy matrix (2D) to apply the transpose
OR data[].reshape(-1,1) can be also used to mimick the transpose.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A_trans</strong> – np.eye(mk) * epsilon</p></li>
<li><p><strong>grad</strong> – Gradient, the return of the function grad_calc.</p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.arima_ogd">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">arima_ogd</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.arima_ogd" title="Permalink to this definition">¶</a></dt>
<dd><p>from arima_ogd.m
Used by example.py. ARIMA Online Newton Step algorithm.
The function was originally written in MATLAB by Liu, C.; Hoi, S. C. H.; Zhao, P.; and Sun, J.
It’s described in their work “Online arima algorithms for time series prediction.”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Array of 10000 elements.</p></li>
<li><p><strong>options</strong> – Instance of ClassOptions class.</p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.arima_ons">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">arima_ons</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.arima_ons" title="Permalink to this definition">¶</a></dt>
<dd><p>from arima_ons.m. ARIMA Online Newton Step algorithm
Used by example.py.
The function was originally written in MATLAB by Liu, C.; Hoi, S. C. H.; Zhao, P.; and Sun, J.
It’s described in their work “Online arima algorithms for time series prediction.”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Array of 10000 elements.</p></li>
<li><p><strong>options</strong> – Instance of ClassOptions class.</p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.close_all_figs">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">close_all_figs</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.close_all_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes all the figures. Originally the function comes from experiments.py file.</p>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.cost_ar">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">cost_ar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.cost_ar" title="Permalink to this definition">¶</a></dt>
<dd><p>Loss function of auto-regression.
After the prediction is made, the true observation is revealed to
the algorithm, and a loss associated with the prediction is computed.
Here we consider the quadratic loss for simplicity.
Originally the function comes from onlinelds.py file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> – auto-regressive parameters.</p></li>
<li><p><strong>args</strong><strong>[</strong><strong>0</strong><strong>]</strong> – observation at time t</p></li>
<li><p><strong>args</strong><strong>[</strong><strong>1</strong><strong>]</strong> – past s observations (most to least recent: t-1 to t-1-s)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Quadratic loss function of auto-regression.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.diff_calc">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">diff_calc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.diff_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Auxiliary function to implement ARIMA in python. Others functions use it in their
iterations.
MATLAB: diff = w*data(i-mk:i-1)’-data(i);
remember! MATLAB_data(1) == Python_data[0]
we have to convert data[] from 1D vector to a numpy matrix (2D) to apply the transpose
OR data[].reshape(-1,1) can be also used to mimick the transpose</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> – Uniform distribution array with options.mk number of columns.</p></li>
<li><p><strong>data</strong> – Array of 10000 elements.</p></li>
<li><p><strong>mk</strong> – Integer number. Here we used 10.</p></li>
<li><p><strong>i</strong> – Iterative number. In range from mk till data - 1.</p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.error_stat">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">error_stat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error_spec_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_persist_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.error_stat" title="Permalink to this definition">¶</a></dt>
<dd><p>if have_spectral_persistent:</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Mean error of spectral filtering
error_spec_std:     Std of spectral filtering error
error_persist_mean: Mean error of last-value prediction
error_persist_std:  Std of last-value prediction error</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>error_spec_mean</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.grad_calc">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">grad_calc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.grad_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>MATLAB: grad = 2*data(i-mk:i-1)*diff
Used by function arima_ons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Array of 10000 elements.</p></li>
<li><p><strong>i</strong> – Iterative number. In range from mk till data - 1.</p></li>
<li><p><strong>mk</strong> – Integer number. Here we used 10.</p></li>
<li><p><strong>diff</strong> – Result of diff_calc function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gradient.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.gradient_ar">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">gradient_ar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.gradient_ar" title="Permalink to this definition">¶</a></dt>
<dd><p>Gradient function of auto-regression.
We use the general scheme of on-line gradient decent algorithms,
where the update goes against the direction of the gradient of the current loss.
In addition, it is useful to restrict the state to a bounded domain.
Originally the function comes from onlinelds.py file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> – s parameters.</p></li>
<li><p><strong>args</strong><strong>[</strong><strong>0</strong><strong>]</strong> – Observation.</p></li>
<li><p><strong>args</strong><strong>[</strong><strong>1</strong><strong>]</strong> – Past s observations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gradient function of auto-regression.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.heatmap">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">heatmap</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbarlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.heatmap" title="Permalink to this definition">¶</a></dt>
<dd><p>The function is taken from pyplot documentation.
Create a heatmap from a numpy array and two lists of labels.
Used by testNoiseImpact to implement <a class="reference internal" href="#fig3"><span class="std std-numref">Fig. 1</span></a> and <a class="reference internal" href="#fig6"><span class="std std-numref">Fig. 2</span></a>.
Originally the function comes from experiments.py file.</p>
<div class="figure align-default" id="id3">
<span id="fig3"></span><img alt="fig3" src="_images/Figure3.png" />
<p class="caption"><span class="caption-number">Fig. 1 </span><span class="caption-text">The ratio of the errors of Kalman filter and AR(2) on Example 7 from Marecek’s paper
indicated by colours as a function of <img class="math" src="_images/math/ce901d5eb0e79e936ababf650dcb9a1685a1f093.png" alt="w, v"/> of process and observation noise, on
the vertical and horizontal axes, resp. Origin is the top-left corner.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id4">
<span id="fig6"></span><img alt="fig6" src="_images/Figure6.png" />
<p class="caption"><span class="caption-number">Fig. 2 </span><span class="caption-text">The effect of varying the magnitude of noise in Example 7 on AR(2)
(top), AR(4) (middle), and AR(8) (bottom). Left: average RMSE of predictions
of AR(s+ 1) as a function of the variance of the process noise (vertical axis) and
observation noise (horizontal axis). Center: The differences in average RMSE of
Kalman filters and AR(s + 1) as a function of the variance of the process noise
(vertical axis) and observation noise (horizontal axis). Throughout averages are
taken over 10 runs. Right: The ratio (70) of the errors of Kalman filters and
AR(s + 1) as a function of the variance of the process noise (vertical axis) and
observation noise (horizontal axis). Throughout, notice the origin is in the topleft corner.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – A 2D numpy array of shape (N,M)</p></li>
<li><p><strong>row_labels</strong> – A list or array of length N with the labels
for the rows</p></li>
<li><p><strong>col_labels</strong> – A list or array of length M with the labels
for the columns</p></li>
</ul>
</dd>
<dt class="field-even">Optional arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ax</strong> – A matplotlib.axes.Axes instance to which the heatmap
is plotted. If not provided, use current axes or
create a new one.</p></li>
<li><p><strong>cbar_kw</strong> – A dictionary with arguments to
<code class="xref py py-meth docutils literal notranslate"><span class="pre">matplotlib.Figure.colorbar()</span></code>.</p></li>
<li><p><strong>cbarlabel</strong> – The label for the colorbar</p></li>
</ul>
</dd>
</dl>
<p>All other arguments are directly passed on to the imshow call.</p>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.lab">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">lab</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_zero</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.lab" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives a label to auto-regression outputs and labels in seq0,seq1,seq2 pdfs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>auto-regression label. Example: “AR(2), c = 2500”.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>lab1</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.p3_for_test_identification2">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">p3_for_test_identification2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ylim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">have_spectral_persistent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tlim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_spec_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_spec_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaValue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_persist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_persist_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_persist_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_AR1_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_AR1_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">have_kalman</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_Kalman_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_Kalman_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.p3_for_test_identification2" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots <a class="reference internal" href="#fig2"><span class="std std-numref">Fig. 3</span></a>, <a class="reference internal" href="#fig5"><span class="std std-numref">Fig. 4</span></a> after getting all the errors data.
In <a class="reference internal" href="#fig2"><span class="std std-numref">Fig. 3</span></a>, we compare the prediction error for 4 methods:
the standard baseline last-value prediction <img class="math" src="_images/math/8546ab635720ef88175accee3dbb128c24ef539f.png" alt="\hat{y}_{t+1} := y_t"/>, also
known as persistence prediction, the spectral filtering of
\cite{hazan2017online}, Kalman filter, and AR(2).</p>
<p>We first continue the Example \ref{HazanEx} form the main body of the
paper, with a system given by (\ref{eq:experem1_system_hazan}) and
<img class="math" src="_images/math/a032b14dada253b596be32e4f6287523183fde0f.png" alt="v=w=0.5"/>. Figure \ref{fig1}(right) shows a sample observations
trajectory of the system, together with forecast for the four methods.
Figure \ref{fig1}(left) show the mean and standard deviations of the
errors for the first 500 time steps. Figure \ref{fig1brief} in the main
text is the restriction of this Figure \ref{fig1}(left) to the first 20
steps. Similarly to Figure \ref{fig1brief}, we observe that the AR(2)
predictions are better than the spectral and persistence methods, and
worse than the Kalman filter, since only two first terms are considered.</p>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.plot_p1">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">plot_p1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ymin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">have_spectral_persistent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_spectral</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_ar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.plot_p1" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots seq0, seq1, seq2, logratio pdf files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ymin</strong> – Minimal value of y-axis.</p></li>
<li><p><strong>ymax</strong> – Maximal value of y-axis.</p></li>
<li><p><strong>inputs</strong> – Input to the system matrix.</p></li>
<li><p><strong>sequence_label</strong> – Plot’s label.</p></li>
<li><p><strong>have_spectral_persistent</strong> – True if we want to build spectral and persistent filters.</p></li>
<li><p><strong>predicted_spectral</strong> – Predicted values of spectral filter. If
have_spectral_persistent is False, it’s equal to an empty list.</p></li>
<li><p><strong>predicted_ar</strong> – Predicted values of auto-regression.</p></li>
<li><p><strong>sys</strong> – Linear Dynamical System created with DynamicalSystem class.</p></li>
<li><p><strong>p_p</strong> – PDF file, to which are export the plots.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.plot_p2">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">plot_p2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">have_spectral_persistent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_persist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_ar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.plot_p2" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots seq0, seq1, seq2, logratio pdf files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>have_spectral_persistent</strong> – True if we want to build spectral and persistent filters.</p></li>
<li><p><strong>error_spec</strong> – Spectral filter error.</p></li>
<li><p><strong>error_persist</strong> – Persistent filter error.</p></li>
<li><p><strong>error_ar</strong> – Auto-regression error.</p></li>
<li><p><strong>lab</strong> – Auto-regression plot label.</p></li>
<li><p><strong>p_p</strong> – PDF file, to which are export the plots.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.plot_p3">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">plot_p3</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ymin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">have_spectral_persistent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_spec_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_spec_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_persist_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_persist_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_ar_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_ar_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.plot_p3" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots seq0, seq1, seq2, logratio pdf files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ymin</strong> – Minimal value of y-axis.</p></li>
<li><p><strong>ymax</strong> – Maximal value of y-axis.</p></li>
<li><p><strong>have_spectral_persistent</strong> – True if we want to build spectral and persistent filters.</p></li>
<li><p><strong>error_spec_mean</strong> – Mean error of spectral filtering.</p></li>
<li><p><strong>error_spec_std</strong> – Std of spectral filtering error.</p></li>
<li><p><strong>error_persist_mean</strong> – Mean error of last-value prediction.</p></li>
<li><p><strong>error_persist_std</strong> – Std of last-value prediction error.</p></li>
<li><p><strong>error_ar_mean</strong> – Mean error of auto-regression.</p></li>
<li><p><strong>error_ar_std</strong> – Std of auto-regression error.</p></li>
<li><p><strong>p_p</strong> – PDF file, to which are export the plots.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.pre_comp_filter_params">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">pre_comp_filter_params</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_dash</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proc_noise_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_noise_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.pre_comp_filter_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Kalman filter auxiliary recursive parameters calculation.</p>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.prediction">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">prediction</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_dash</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Auto-regression prediction values.
Finds the formula for Figure 1(AR(s+1)):
The unrolling of the forecast <img class="math" src="_images/math/e3dc93491af6961ff6666eb336a3f998f4582f04.png" alt="f_{t+1}"/>.
The remainder term goes to zero exponentially fast with <img class="math" src="_images/math/106b04b320e75010b1d8029e59244f234f75e6f9.png" alt="s"/>, by Lemma</p>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.prediction_kalman">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">prediction_kalman</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_dash</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.prediction_kalman" title="Permalink to this definition">¶</a></dt>
<dd><p>Kalman filter prediction values</p>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.testImpactOfS">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">testImpactOfS</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_runs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sMax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.testImpactOfS" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates file ‘./outputs/impacts.pdf’, which stores plots of average error of auto-regression
as a function of regression depth s. In the main paper we present it again with Example 7
and Figure 4.
Increasing s decreases the error, until the error approaches that of the Kalman filter.
For a given value of the observation noise, the convergence w.r.t s is slower for
smaller process noise.
Originally the function comes from experiments.py file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_t</strong> – Time horizon.</p></li>
<li><p><strong>no_runs</strong> – Number of runs.</p></li>
<li><p><strong>sMax</strong> – Number of auto-regressive terms.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exits if sMax &gt; t_t.</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.testNoiseImpact">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">testNoiseImpact</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_runs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discretisation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.testNoiseImpact" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces ‘./outputs/noise.pdf’. Plots heatmap of process noise variance
vs observation noise variance based on relative error between any two
predictive algorithms. LaTeX shows the example of the ratio of the errors
of Kalman filter and AR(2)(see <a class="reference internal" href="#fig3"><span class="std std-numref">Fig. 1</span></a>).
Originally the function comes from experiments.py file.</p>
<p>Plots RMSE of AR :numref:<a href="#id1"><span class="problematic" id="id2">`</span></a>fig6`(left) :
average RMSE of predictions of AR(s+ 1) as a function of the variance of the
process noise (vertical axis) and observation noise (horizontal axis).</p>
<p>Plots <a class="reference internal" href="#fig6"><span class="std std-numref">Fig. 2</span></a> (center):
The differences in average RMSE of Kalman filters and AR(s + 1) as a function
of the variance of the process noise (vertical axis) and observation noise (horizontal axis).</p>
<p>Plots <a class="reference internal" href="#fig6"><span class="std std-numref">Fig. 2</span></a> (right):
The ratio (70) of the errors of Kalman filters and AR(s + 1) as a function of
the variance of the process noise (vertical axis) and observation noise (horizontal axis).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_t</strong> – Time horizon.</p></li>
<li><p><strong>no_runs</strong> – Number of runs.</p></li>
<li><p><strong>discretisation</strong> – Number of trajectories.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.testSeqD0">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">testSeqD0</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_runs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.testSeqD0" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes several initiations of test_identification function so as to plot “logratio.pdf” and
“seq0.pdf”, “seq1.pdf”, “seq2.pdf”. Originally the function comes from experiments.py file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>no_runs</strong> – Number of runs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.test_AR">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">test_AR</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.test_AR" title="Permalink to this definition">¶</a></dt>
<dd><p>Function implements Algorithm 1(On-line Gradient Descent).
Originally the function comes from experiments.py file.</p>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.test_arima_ogd">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">test_arima_ogd</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lrate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.test_arima_ogd" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to test arima_ogd function for i=10 case.
The test cases are based on MATLAB:
The test numbers were taken from the output of MATLAB function,
the random array w is fixed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – Iterative number. In range from mk till data - 1.</p></li>
<li><p><strong>mk</strong> – Integer number. Here we used 10.</p></li>
<li><p><strong>lrate</strong> – Learning rate. Assigned 1 in example.py.</p></li>
<li><p><strong>data</strong> – Array of 10000 elements.</p></li>
</ul>
</dd>
</dl>
<p>Raises:</p>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.test_arima_ons">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">test_arima_ons</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lrate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A_trans_in</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.test_arima_ons" title="Permalink to this definition">¶</a></dt>
<dd><p>to test arima_ons function
the test casees are based on MATLAB:
the test numbers were taken from the output of MATLAB function
the random array w is fixed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – </p></li>
<li><p><strong>mk</strong> – </p></li>
<li><p><strong>lrate</strong> – </p></li>
<li><p><strong>data</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.test_identification">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">test_identification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename_stub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'test'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_runs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_zeros</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">have_spectral_persistent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.test_identification" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements here On-line Gradient Descent Algorithm 1 by the use of cost_ar and gradient_ar
functions.
Data found is used by plot_p1,plot_p2, plot_p3 functions which create “seq0”, “logration” pdfs.
Implements Example 8 from Experiments section of the original paper.
Plots Figures 7,8.
Originally the function comes from experiments.py file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sys</strong> – LDS.</p></li>
<li><p><strong>filename_stub</strong> – Name of the output file.</p></li>
<li><p><strong>no_runs</strong> – Number of runs.</p></li>
<li><p><strong>t_t</strong> – Time horizon.</p></li>
<li><p><strong>k</strong> – Number of filters.</p></li>
<li><p><strong>eta_zeros</strong> – Learning rate.</p></li>
<li><p><strong>y_min</strong> – Minimal value of y-axis.</p></li>
<li><p><strong>y_max</strong> – Maximal value of y-axis.</p></li>
<li><p><strong>sequence_label</strong> – </p></li>
<li><p><strong>have_spectral_persistent</strong> – False if there’s no need to plot spectral and persistent filters.
Default value - True.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exits if k &gt; t_t.</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.test_identification2">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">test_identification2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_runs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_choices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[15,</span> <span class="pre">3,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">have_kalman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">have_spectral_persistent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.54661607,</span> <span class="pre">0.00607494],</span> <span class="pre">[0.43924336,</span> <span class="pre">0.82128672]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_dash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.18222239,</span> <span class="pre">0.52486075]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.test_identification2" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements Example 7 from Experiments section of the paper.
Creates ‘./outputs/AR.pdf’.Finds all the filters’ errors and
uses function p3_for_test_identification2 for plotting them.
Plots <a class="reference internal" href="#fig2"><span class="std std-numref">Fig. 3</span></a>,:numref:<cite>fig5</cite>. Plots Figure 2,5 of the main paper.
Originally the function comes from experiments.py file.</p>
<div class="figure align-default" id="id5">
<span id="fig2"></span><img alt="fig2" src="_images/Figure2.png" />
<p class="caption"><span class="caption-number">Fig. 3 </span><span class="caption-text">The error of AR(2) compared against Kalman filter, last-value prediction,
and spectral filtering in terms of the mean and standard deviation over
N = 100 runs on Example 7.</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id6">
<span id="fig5"></span><img alt="fig5" src="_images/Figure5.png" />
<p class="caption"><span class="caption-number">Fig. 4 </span><span class="caption-text">Left: sample outputs and predictions with AR(2), compared against Kalman filter,
last-value prediction, and spectral filtering of Hazan, Singh, and Zhang (2017).
Right: Same as <a class="reference internal" href="#fig2"><span class="std std-numref">Fig. 3</span></a>, over longer time period.</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_t</strong> – Time horizon.</p></li>
<li><p><strong>no_runs</strong> – Number of runs.</p></li>
<li><p><strong>s_choices</strong> – </p></li>
<li><p><strong>have_kalman</strong> – False if there’s no need to plot kalman filter.
Default value - True.</p></li>
<li><p><strong>have_spectral_persistent</strong> – False if there’s no need to plot spectral and persistent filters.
Default value - True.</p></li>
<li><p><strong>G</strong> – State matrix.</p></li>
<li><p><strong>f_dash</strong> – first derivative of the observation direction.</p></li>
<li><p><strong>sequence_label</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exits if number of runs is less than 2.</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.w_calc">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">w_calc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lrate</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.w_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Auxiliary function to implement ARIMA in python. Others functions use it in their
iterations.
MATLAB: w = w - data(i-mk:i-1)*2*diff/sqrt(i-mk)*lrate;</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> – Uniform distribution array with options.mk number of columns.</p></li>
<li><p><strong>data</strong> – Array of 10000 elements.</p></li>
<li><p><strong>mk</strong> – Integer number. Here we used 10.</p></li>
<li><p><strong>i</strong> – Iterative number. In range from mk till data - 1.</p></li>
<li><p><strong>diff</strong> – Result of diff_calc function</p></li>
<li><p><strong>lrate</strong> – Learning rate. Assigned 1 in example.py.</p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py function">
<dt id="LDS.OnlineLDS_library.w_calc_arima_ons">
<code class="sig-prename descclassname"><span class="pre">LDS.OnlineLDS_library.</span></code><code class="sig-name descname"><span class="pre">w_calc_arima_ons</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lrate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A_trans</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#LDS.OnlineLDS_library.w_calc_arima_ons" title="Permalink to this definition">¶</a></dt>
<dd><p>MATLAB: w = w - lrate * grad * A_trans
Calculation of the weight with Gradient Descent algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> – Uniform distribution array with options.mk number of columns.</p></li>
<li><p><strong>lrate</strong> – Learning rate. Assigned 1 in example.py.</p></li>
<li><p><strong>grad</strong> – Gradient, the return of the function grad_calc.</p></li>
<li><p><strong>A_trans</strong> – Return of the function A_trans_calc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Weight after an iteration of the gradient descent algorithm.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="lds-example-module">
<h2>LDS.example module<a class="headerlink" href="#lds-example-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-LDS.main">
<span id="lds-main-module"></span><h2>LDS.main module<a class="headerlink" href="#module-LDS.main" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-LDS">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-LDS" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="LDS.LDS.html" class="btn btn-neutral float-right" title="LDS.LDS package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="modules.html" class="btn btn-neutral float-left" title="LDS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Kapa Kudaibergenov.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>